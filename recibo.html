<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üßæ Recibo ‚Äî Se√±a / Pago</title>
    <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    :root { --card-border:#e5e7eb; --muted:#6b7280; }
    fieldset{
      border:1px solid var(--card-border); border-radius:10px;
      padding:14px 16px; margin-bottom:16px; background:#fff;
    }
    legend{ font-weight:600; padding:0 6px; }
    label{ display:flex; flex-direction:column; gap:6px; margin-bottom:12px; }
    input,select,textarea{
      padding:9px 10px; border:1px solid #d1d5db; border-radius:8px; outline:none;
    }
    textarea{ min-height:80px; resize:vertical; }
    input:focus,select:focus,textarea:focus{ border-color:#111827; }
    .grid-2{ display:grid; grid-template-columns:1fr; gap:12px; }
    @media (min-width:768px){ .grid-2{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
    .hint{ color:var(--muted); font-size:0.9rem; margin-top:6px; }
    button{
      padding:10px 14px; border-radius:10px; border:0; background:#111827; color:#fff; cursor:pointer;
    }
    button:hover{ opacity:0.92; }
    @media print{
      .navbar,button{ display:none!important; }
      @page{ size:A4; margin:12mm; }
      body{ -webkit-print-color-adjust:exact; print-color-adjust:exact; }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">üöó Jesus Diaz Automotores</div>
    <ul class="nav-links" id="navLinks">
      <li><a href="index.html">Inicio</a></li>
      <li><a href="compra_venta.html">Compra y Venta</a></li>
      <li><a href="autorizacion_conduccion.html">Autorizaci√≥n de Conducci√≥n</a></li>
      <li><a href="datero.html">Datero</a></li>
      <li><a href="recibo.html">Recibo</a></li>
      <li><a href="presupuesto.html">Presupuesto</a></li>
    </ul>
  </nav>

  <main>
    <h2>üßæ Recibo ‚Äî Se√±a / Pago</h2>

    <form id="reciboForm" onsubmit="return false;" novalidate>
      <fieldset class="grid-2">
        <legend>Datos del Recibo</legend>
        <label>N¬∫ de Recibo (auto):
          <input type="text" id="recibo_nro" readonly>
        </label>
        <label>Fecha:
          <input type="date" id="fecha">
        </label>
        <label>Tipo:
          <select id="tipo">
            <option value="SE√ëA">Se√±a</option>
            <option value="PAGO TOTAL">Pago total</option>
            <option value="PAGO">Pago</option>
          </select>
        </label>
        <label>Imprimir duplicado:
          <select id="duplicado">
            <option value="no">No</option>
            <option value="si" selected>S√≠ (Original / Duplicado)</option>
          </select>
        </label>
      </fieldset>

      <fieldset>
        <legend>Quien paga</legend>
        <div class="grid-2">
          <label>Apellido y Nombre / Raz√≥n Social:
            <input type="text" id="cliente">
          </label>
          <label>DNI / CUIT:
            <input type="text" id="doc">
          </label>
        </div>
        <div class="grid-2">
          <label>Domicilio:
            <input type="text" id="domicilio">
          </label>
          <label>Localidad / Provincia:
            <input type="text" id="localidad">
          </label>
        </div>
        <label>Concepto / Detalle:
          <textarea id="concepto" placeholder="Ej: Se√±a por VW Gol Trend 2017; saldo a pactar en la transferencia."></textarea>
        </label>
      </fieldset>

      <fieldset>
        <legend>Importe</legend>
        <div class="grid-2">
          <label>Monto (ARS):
            <input type="number" step="0.01" id="monto" placeholder="0.00">
          </label>
          <label>En letras (auto):
            <input type="text" id="monto_letras" placeholder="cero pesos con 00/100" />
          </label>
        </div>
        <div class="grid-2">
          <label>Forma de pago:
            <select id="forma">
              <option>Efectivo</option>
              <option>Transferencia</option>
              <option>Tarjeta</option>
              <option>Dep√≥sito</option>
              <option>Otro</option>
            </select>
          </label>
          <label>Detalle del pago (Banco/ALIAS/CBU/√öltimos 4):
            <input type="text" id="detalle_pago" placeholder="ALIAS, CBU, Op. #123, etc.">
          </label>
        </div>
      </fieldset>

      <fieldset>
        <legend>Veh√≠culo (opcional)</legend>
        <div class="grid-2">
          <label>Marca y Modelo:
            <input type="text" id="vehiculo">
          </label>
          <label>Dominio:
            <input type="text" id="vehiculo_dominio" style="text-transform:uppercase;">
          </label>
        </div>
      </fieldset>

      <fieldset>
        <legend>Observaciones (opcional)</legend>
        <textarea id="obs" placeholder="Ej: El importe se imputa a cuenta de la operaci√≥n."></textarea>
      </fieldset>

      <div style="display:flex; gap:10px; flex-wrap: wrap;">
        <button type="button" onclick="handleGenerarRecibo()">üìÑ Generar PDF</button>
        <button type="button" onclick="resetearCorrelativo()">‚ôªÔ∏è Reset correlativo</button>
      </div>
    </form>
  </main>

  <script src="recibo.js"></script>
  <script>
    // Inicializa correlativo y helpers UI
    (function init() {
      // correlativo
      const today = new Date();
      const y = today.getFullYear();
      let c = Number(localStorage.getItem('reciboCounter') || '0');
      if (!localStorage.getItem('reciboYear') || localStorage.getItem('reciboYear') !== String(y)) {
        localStorage.setItem('reciboYear', String(y));
        c = 0; localStorage.setItem('reciboCounter', String(c));
      }
      document.getElementById('recibo_nro').value = `REC-${y}-${String(c+1).padStart(4,'0')}`;
      // fecha
      document.getElementById('fecha').value = today.toISOString().slice(0,10);
      // monto‚Üíletras live
      const monto = document.getElementById('monto');
      monto.addEventListener('input', () => actualizarMontoLetras());
      function actualizarMontoLetras(){
        const v = parseFloat(monto.value || '0');
        if (isNaN(v)) return;
        document.getElementById('monto_letras').value = numALetras(v);
      }
    })();

    function resetearCorrelativo(){
      const y = new Date().getFullYear();
      localStorage.setItem('reciboYear', String(y));
      localStorage.setItem('reciboCounter', '0');
      document.getElementById('recibo_nro').value = `REC-${y}-0001`;
      alert('Correlativo reiniciado.');
    }
    function handleGenerarRecibo(){ generarReciboPDF(); }
  </script>
  
<script src="utils.js"></script>
<script>
  requireAuth();
</script>
</body>
</html>
